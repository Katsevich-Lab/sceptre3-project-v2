library(sceptre)
repl_offsite <- paste0(.get_config_path("LOCAL_REPLOGLE_2022_DATA_DIR"))
repl_offsite
repl_offsite
repl_offsite
repl_offsite
repl_offsite
# read sceptre_object imported
import_dir <-  paste0(repl_offsite, "processed/rd7")
# read sceptre_object imported
import_dir <- paste0(repl_offsite, "processed/rd7/")
source("~/research_code/sceptre3-project-v2/rd7_analysis/set_analysis_parameters.R")
read_ondisc_backed_sceptre_object(sceptre_object_fp = paste0(import_dir, "sceptre_object.rds"),
response_odm_file_fp = paste0(import_dir, "gene.odm"),
grna_odm_file_fp = paste0(import_dir, "grna.odm"))
sceptre_object <- read_ondisc_backed_sceptre_object(sceptre_object_fp = paste0(import_dir, "sceptre_object.rds"),
response_odm_file_fp = paste0(import_dir, "gene.odm"),
grna_odm_file_fp = paste0(import_dir, "grna.odm"))
sceptre_object
sceptre_object |> get_grna_matrix()
sceptre_object
sceptre_object
# update the parameters of this sceptre_object
pc_pairs <- construct_positive_control_pairs(sceptre_object)
pc_pairs
?construct_trans_pairs
discovery_pairs <- construct_trans_pairs(sceptre_object = sceptre_object,
positive_control_pairs = pc_pairs,
pairs_to_exclude = "pc_pairs")
head(discovery_pairs)
nrow(discovery_pairs)
discovery_pairs |> pryr::object_size()
head(discovery_pairs)
discovery_pairs$grna_target |> unique() |> length()
targets_to_study <- unique(discovery_pairs$grna_target)[1:100]
discovery_pairs <- discovery_pairs |> dplyr::filter(grna_target %in% targets_to_study)
nrow(discovery_pairs)
sceptre_object
sceptre_object |> print()
formula(~grna_n_nonzero + grna_n_umis + response_n_nonzero + response_n_umis)
~ grna_n_nonzero + grna_n_umis + response_n_nonzero + response_n_umis
# update the parameters of this sceptre_object
positive_control_pairs <- construct_positive_control_pairs(sceptre_object)
positive_control_pairs
nrow(positive_control_pairs)
sceptre_object <- set_analysis_parameters(sceptre_object,
discovery_pairs = discovery_pairs,
positive_control_pairs = positive_control_pairs,
formula_object = formula(~ grna_n_nonzero + grna_n_umis + response_n_nonzero + response_n_umis))
sceptre_object
sceptre_object |> print()
.get_config_path("LOCAL_SCEPTRE3_DATA_DIR")
.get_config_path("LOCAL_SCEPTRE3_DATA_DIR")
sceptre3_rd7_offsite <- paste0(.get_config_path("LOCAL_SCEPTRE3_DATA_DIR"), "replogle-2022")
sceptre3_rd7_offsite
import_dir <- paste0(repl_offsite, "processed/rd7/")
sceptre_object <- read_ondisc_backed_sceptre_object(sceptre_object_fp = paste0(import_dir, "sceptre_object.rds"),
response_odm_file_fp = paste0(import_dir, "gene.odm"),
grna_odm_file_fp = paste0(import_dir, "grna.odm"))
sceptre_object
sceptre3_rd7_offsite
# save the sceptre_object with analysis parameters set
write_ondisc_backed_sceptre_object(sceptre_object = sceptre_object,
directory_to_write = sceptre3_rd7_offsite)
sceptre3_rd7_offsite <- paste0(.get_config_path("LOCAL_SCEPTRE3_DATA_DIR"), "replogle-2022/rd7/")
sceptre3_rd7_offsite <- paste0(.get_config_path("LOCAL_SCEPTRE3_DATA_DIR"), "replogle-2022/rd7/")
# save the sceptre_object with analysis parameters set
write_ondisc_backed_sceptre_object(sceptre_object = sceptre_object,
directory_to_write = sceptre3_rd7_offsite)
?plot_run_qc
load_all()
library(sceptre)
repl_offsite <- paste0(.get_config_path("LOCAL_REPLOGLE_2022_DATA_DIR"))
sceptre3_rd7_offsite <- paste0(.get_config_path("LOCAL_SCEPTRE3_DATA_DIR"), "replogle-2022/rd7/")
import_dir <- paste0(repl_offsite, "processed/rd7/")
sceptre_object <- read_ondisc_backed_sceptre_object(sceptre_object_fp = paste0(import_dir, "sceptre_object.rds"),
response_odm_file_fp = paste0(import_dir, "gene.odm"),
grna_odm_file_fp = paste0(import_dir, "grna.odm"))
sceptre_object@grna_target_data_frame |> head()
sceptre_object@grna_target_data_frame_with_vector
sceptre_object@grna_target_data_frame_with_vector |> dplyr::filter(grna_target != "non-targeting")
?sceptre
